# 更新日志

## 2024-12-29 (更新) - 武器分布可视化

### 新增功能
- **武器分布图表**: 添加了武器获取数量的分布柱状图（橙色）
- **独立保存**: 角色和武器的分布图分别保存为独立的PNG文件
- **完整标签**: 所有图表都包含清晰的标题、坐标轴标签和百分比标注

### 主要变更

#### main.py
1. **print_result_no_of_targets函数增强**：
   - 生成两个独立的柱状图：角色分布（蓝色）和武器分布（橙色）
   - 文件命名：`{title}_characters.png` 和 `{title}_weapons.png`
   - 图表标题明确区分角色和武器
   - 坐标轴标签更加精确

## 2024-12-29 - 武器池功能添加

### 新增功能
- **武器池模拟**: 添加了完整的武器池抽卡模拟功能
- **综合统计**: 结果现在同时显示角色和武器的获取情况

### 主要变更

#### zmd_pool.py
1. **WeaponPoolZmd类**：
   - 实现了10连抽取逻辑 (`pull_x10`)
   - 支持4次申领必出6星武器（40抽保底）
   - 支持8次申领必出UP武器（80抽大保底）
   - 基础概率：4%出6星武器，25%概率为UP武器

2. **三个策略函数全面升级**：
   
   **pull_only_when_have_80_pulls_till_get_target_no_topup（小保派）**：
   - 手里至少有80抽角色池才开始抽
   - 抽到目标角色后开始抽武器
   - 每10抽角色池获得0.2抽武器池
   - 每个6星角色获得1抽武器池
   
   **pull_only_when_have_120_pulls_till_get_target_no_topup（大保派）**：
   - 手里至少有120抽角色池才开始抽
   - 其他规则同小保派
   
   **pull_for_each_target_with_topup（全图鉴党）**：
   - 必得每期UP角色+UP武器各一次
   - 分别追踪角色池和武器池的充值需求
   - 返回 (角色充值数, 武器充值数) 元组

#### main.py
1. **创建武器池实例**：
   - 为8个版本各创建对应的武器池
   - 将角色池和武器池配对成元组

2. **更新结果展示函数**：
   
   **print_result_no_of_targets**：
   - 同时显示角色和武器的平均获取数
   - 显示角色和武器的中位数
   - 显示角色获取分布图
   
   **print_result_no_of_topups**：
   - 分别显示角色池和武器池的充值统计
   - 显示平均值、中位数、80分位数
   - 分别展示角色和武器的充值分布

3. **主程序更新**：
   - 添加武器池初始余额参数（开服5抽，每版本10抽）
   - 所有模拟函数调用都传入武器池参数
   - 移除了Gatch Standard类型的角色池

### 抽卡机制说明

#### 角色池（ZMD）
- 基础概率：0.8%
- UP概率：50%
- 65抽后每抽提升5%概率
- 80抽必出6星
- 120抽必出UP（大保底）

#### 武器池（ZMD）
- 基础概率：4%
- UP概率：25%
- 4次申领（40抽）必出6星武器
- 8次申领（80抽）必出UP武器
- 每次申领 = 10连抽

#### 资源转换规则
- 每10抽角色池 → 0.2抽武器池
- 每个6星角色 → 1抽武器池

### 测试结果示例

**小保派策略（80抽才抽）**：
- 平均获得角色：6.66/8 (83.2%)
- 平均获得武器：4.58/8 (57.3%)

**大保派策略（120抽才抽）**：
- 平均获得角色：6.72/8 (84.0%)
- 平均获得武器：4.73/8 (59.1%)

**全图鉴党策略（充值）**：
- 平均角色充值：41.63抽
- 平均武器充值：0抽（基础资源足够）
